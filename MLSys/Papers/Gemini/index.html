
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../Megatron-LM-v2/">
      
      
        <link rel="next" href="../../CMU10414/">
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.4.7">
    
    
      
        <title>Gemini - ÂáâÁ≤•ÁöÑÂ≠¶‰π†Á¨îËÆ∞</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.4b4a2bd9.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.356b1318.min.css">
      
      

  
  
  
  
  <style>:root{--md-annotation-icon:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 13h-4v4h-2v-4H7v-2h4V7h2v4h4m-5-9A10 10 0 0 0 2 12a10 10 0 0 0 10 10 10 10 0 0 0 10-10A10 10 0 0 0 12 2Z"/></svg>');}</style>


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noto+Serif+SC:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Noto Serif SC";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../css/timeago.css">
    
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/katex.min.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#1-overview" class="md-skip">
          Ë∑≥ËΩ¨Ëá≥
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="È°µÁúâ">
    <a href="../../.." title="ÂáâÁ≤•ÁöÑÂ≠¶‰π†Á¨îËÆ∞" class="md-header__button md-logo" aria-label="ÂáâÁ≤•ÁöÑÂ≠¶‰π†Á¨îËÆ∞" data-md-component="logo">
      
  <img src="../../../logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            ÂáâÁ≤•ÁöÑÂ≠¶‰π†Á¨îËÆ∞
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Gemini
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
</form>
      
    
    
    
    
      <div class="md-header__source">
        <a href="https://github.com/ColdPorridge/notebook" title="ÂâçÂæÄ‰ªìÂ∫ì" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    ColdPorridge/notebook
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Ê†áÁ≠æ" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../.." class="md-tabs__link">
          
  
    
  
  ‰∏ªÈ°µ

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../OS/" class="md-tabs__link">
          
  
    
  
  OS

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../Networking/RDMA/" class="md-tabs__link">
          
  
    
  
  Networking

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../DB/" class="md-tabs__link">
          
  
    
  
  DB

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../Distributed%20System/" class="md-tabs__link">
          
  
    
  
  Distributed Systems

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../" class="md-tabs__link">
          
  
    
  
  MLSys

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../DL%26ML/" class="md-tabs__link">
          
  
    
  
  DL&ML

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../Web/" class="md-tabs__link">
          
  
    
  
  ÊùÇ

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="ÂØºËà™Ê†è" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="ÂáâÁ≤•ÁöÑÂ≠¶‰π†Á¨îËÆ∞" class="md-nav__button md-logo" aria-label="ÂáâÁ≤•ÁöÑÂ≠¶‰π†Á¨îËÆ∞" data-md-component="logo">
      
  <img src="../../../logo.png" alt="logo">

    </a>
    ÂáâÁ≤•ÁöÑÂ≠¶‰π†Á¨îËÆ∞
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/ColdPorridge/notebook" title="ÂâçÂæÄ‰ªìÂ∫ì" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    ColdPorridge/notebook
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    
    
      
        
          
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../.." class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    ‰∏ªÈ°µ
  </span>
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            ‰∏ªÈ°µ
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../OS/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    OS
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            OS
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    
    
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Storage stack
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            Storage stack
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../OS/Storagestack/IO/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Âá†ÁßçÂ∏∏ËßÅÁöÑIOÊñπÂºè
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Networking
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Networking
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../Networking/RDMA/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RDMA
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
      
        
          
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../DB/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    DB
  </span>
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            DB
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../Distributed%20System/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Distributed Systems
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5" id="__nav_5_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Distributed Systems
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../Distributed%20System/%E5%89%91%E6%A1%A5%E5%88%86%E5%B8%83%E5%BC%8F/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    ÂâëÊ°•ÂàÜÂ∏ÉÂºèÁ≥ªÁªüËØæÁ®ã
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_2" id="__nav_5_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2">
            <span class="md-nav__icon md-icon"></span>
            ÂâëÊ°•ÂàÜÂ∏ÉÂºèÁ≥ªÁªüËØæÁ®ã
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../Distributed%20System/%E5%89%91%E6%A1%A5%E5%88%86%E5%B8%83%E5%BC%8F/L1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1. Introduction
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../Distributed%20System/%E5%89%91%E6%A1%A5%E5%88%86%E5%B8%83%E5%BC%8F/L2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2. Models of distributed systems
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../Distributed%20System/%E5%89%91%E6%A1%A5%E5%88%86%E5%B8%83%E5%BC%8F/L3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3. Time, clocks, and ordering of events
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../Distributed%20System/%E5%89%91%E6%A1%A5%E5%88%86%E5%B8%83%E5%BC%8F/L4/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4. Broadcast protocols and logical time
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    MLSys
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6" id="__nav_6_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            MLSys
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    
    
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_2" >
        
          
          <label class="md-nav__link" for="__nav_6_2" id="__nav_6_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Networking
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_2">
            <span class="md-nav__icon md-icon"></span>
            Networking
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Networking/index.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    None
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Networking/ARK/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ARK
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_3" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Papers
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_3" id="__nav_6_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_6_3">
            <span class="md-nav__icon md-icon"></span>
            Papers
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../LoRA/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    LoRA
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../FlashAttention/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FlashAttention
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../LLaMA-Adapter/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    LLaMA-Adapter
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../MixedPrecisionTraining/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mixed Precision Training
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../PipeDream.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PipeDream
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../Megatron-LM-v2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Megatron-LM-v2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Gemini
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Gemini
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="ÁõÆÂΩï">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      ÁõÆÂΩï
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-overview" class="md-nav__link">
    1. Overview
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-background" class="md-nav__link">
    2. Background
  </a>
  
    <nav class="md-nav" aria-label="2. Background">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-frequent-failures-in-model-training" class="md-nav__link">
    2.1 Frequent failures in model training
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22-wasted-time-for-failure-recovery" class="md-nav__link">
    2.2 Wasted time for failure recovery
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#23-limitations-of-existing-solutions" class="md-nav__link">
    2.3 Limitations of Existing Solutions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#24-opportunity" class="md-nav__link">
    2.4 Opportunity
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-designs" class="md-nav__link">
    3. Designs
  </a>
  
    <nav class="md-nav" aria-label="3. Designs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-checkpoint-placement" class="md-nav__link">
    3.1 Checkpoint Placement
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-traffic-interleaving" class="md-nav__link">
    3.2 Traffic Interleaving
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#33-system-architecture" class="md-nav__link">
    3.3 System Architecture
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-evaluation" class="md-nav__link">
    4. Evaluation
  </a>
  
    <nav class="md-nav" aria-label="4. Evaluation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#41-training-time" class="md-nav__link">
    4.1 Training time
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42-wasted-time" class="md-nav__link">
    4.2 Wasted time
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_4" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../CMU10414/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    CMU 10-414/714
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_4" id="__nav_6_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_4">
            <span class="md-nav__icon md-icon"></span>
            CMU 10-414/714
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../CMU10414/basics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Deep learning basics
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../CMU10414/AD/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Automatic Differentiation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../CMU10414/NN/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Neural Network Abstraction
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../CMU10414/NN_impl/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Neural Network Implementation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../CMU10414/GPU_acc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hardware Acceleration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../CMU10414/Hardware_impl/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hardware Acceleration Implementation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../CMU10414/train_large_model/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Training Large Models
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Basic_summary/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Basic Summary
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../DL%26ML/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    DL&ML
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_7" id="__nav_7_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            DL&ML
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../DL%26ML/Transformer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Transformer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../DL%26ML/GPT/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GPT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../DL%26ML/HELM/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HELM
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../DL%26ML/FLAN/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FLAN
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../DL%26ML/Self-Instruct/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Self-Instruct
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../Web/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    ÊùÇ
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_8" id="__nav_8_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            ÊùÇ
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    
    
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_2" >
        
          
          <label class="md-nav__link" for="__nav_8_2" id="__nav_8_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    ÊµèËßàÂô®ÂÜÖÊ†∏
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_8_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_2">
            <span class="md-nav__icon md-icon"></span>
            ÊµèËßàÂô®ÂÜÖÊ†∏
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../Web/Browser%20Kernel/webview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    WebView
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="ÁõÆÂΩï">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      ÁõÆÂΩï
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-overview" class="md-nav__link">
    1. Overview
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-background" class="md-nav__link">
    2. Background
  </a>
  
    <nav class="md-nav" aria-label="2. Background">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-frequent-failures-in-model-training" class="md-nav__link">
    2.1 Frequent failures in model training
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22-wasted-time-for-failure-recovery" class="md-nav__link">
    2.2 Wasted time for failure recovery
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#23-limitations-of-existing-solutions" class="md-nav__link">
    2.3 Limitations of Existing Solutions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#24-opportunity" class="md-nav__link">
    2.4 Opportunity
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-designs" class="md-nav__link">
    3. Designs
  </a>
  
    <nav class="md-nav" aria-label="3. Designs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-checkpoint-placement" class="md-nav__link">
    3.1 Checkpoint Placement
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-traffic-interleaving" class="md-nav__link">
    3.2 Traffic Interleaving
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#33-system-architecture" class="md-nav__link">
    3.3 System Architecture
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-evaluation" class="md-nav__link">
    4. Evaluation
  </a>
  
    <nav class="md-nav" aria-label="4. Evaluation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#41-training-time" class="md-nav__link">
    4.1 Training time
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42-wasted-time" class="md-nav__link">
    4.2 Wasted time
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


  <h1>Gemini</h1>

<p><img alt="Alt text" src="../assets/image-84.png" /></p>
<h2 id="1-overview">1. Overview<a class="headerlink" href="#1-overview" title="Permanent link">&para;</a></h2>
<figure>
<p><img alt="Alt text" src="../assets/image-106.png" /></p>
</figure>
<ul>
<li>
<p>Existing solutions have significant failure recovery costs due to the severe restriction imposed by the <strong>bandwidth of remote storage (ÔºàFSx in AWS„ÄÅCFS in Tencent„ÄÅVeFPS in ByteDance„ÄÅNAS in Alibaba)in which they store checkpoints</strong>.</p>
</li>
<li>
<p>This paper presents Gemini, a distributed training system that enables fast failure recovery for large model training by <strong>checkpointing to CPU memory of the host machines with much larger aggregated bandwidth.</strong></p>
</li>
</ul>
<p><strong>Challenges:</strong></p>
<p><strong>How to maximize the probability of failure recovery from checkpoints stored in CPU memory?</strong></p>
<p><strong>How to minimize the interference of checkpoint traffic with model training?</strong></p>
<h2 id="2-background">2. Background<a class="headerlink" href="#2-background" title="Permanent link">&para;</a></h2>
<h3 id="21-frequent-failures-in-model-training">2.1 Frequent failures in model training<a class="headerlink" href="#21-frequent-failures-in-model-training" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p>OPT model training reports: training OPT-175B used 992 NVIDIA A100 GPUs, and the training process encountered around <strong>110 failures over a period of two months</strong><sup id="fnref:1"><a class="footnote-ref" href="#fn:1">1</a></sup></p>
</li>
<li>
<p>Facebook AI's analysis of the <strong>production cluster</strong> shows that checkpoint-related overheads in full recovery can consume an <strong>average of 12% of the total training time</strong>. For the worst 5%, training time slowdown can be <strong>up to 43%</strong>. This 12% overhead can add up to a significant computational cost at scale.<sup id="fnref:2"><a class="footnote-ref" href="#fn:2">2</a></sup></p>
</li>
</ul>
<h3 id="22-wasted-time-for-failure-recovery">2.2 Wasted time for failure recovery<a class="headerlink" href="#22-wasted-time-for-failure-recovery" title="Permanent link">&para;</a></h3>
<div class="admonition example">
<p><figure markdown>
  <img alt="Alt text" src="../assets/image-87.png" width="500" />
</figure></p>
</div>
<p>the average wasted time (denoted as <span class="arithmatex">\(T_{wasted}\)</span>) can be expressed as:</p>
<div class="arithmatex">\[
T_{\text {wasted }}=t_{c k p t}+\frac{1}{2 f}+t_{r t v l}
\]</div>
<p>In addition, we have the following constraint:</p>
<div class="arithmatex">\[
1 / f \geq \max \left(t_{c k p t}, T_{i t e r}\right)
\]</div>
<h3 id="23-limitations-of-existing-solutions">2.3 Limitations of Existing Solutions<a class="headerlink" href="#23-limitations-of-existing-solutions" title="Permanent link">&para;</a></h3>
<p>To reduce the wasted time, it is critical to reduce checkpoint time <span class="arithmatex">\(t_{c k p t}\)</span> to enable a higher checkpoint frequency <span class="arithmatex">\(f\)</span>, and the optimal frequency <span class="arithmatex">\(f\)</span> is every iteration <span class="arithmatex">\(1 / T_{\text {iter }}\)</span>.</p>
<p>It is infeasible to arbitrarily increase the checkpoint frequency because <strong>checkpoint frequency is bottlenecked by the bandwidth of the remote persistent storage</strong>.</p>
<details class="example">
<summary>MT-NLG</summary>
<p>42 minutes to checkpoint the model states of MT-NLG(530B)  to the remote persistent storage when the bandwidth is 20Gbps(AWs FSx). The average wasted time for failure recovery is 42 + 21 + 42 = 105 minutes, which makes the training system less efficient.</p>
<div class="admonition question">
<p class="admonition-title">Why 42 minutes?</p>
</div>
</details>
<details class="info">
<summary>related work</summary>
<ul>
<li>
<p>DeepFreeze(CCGRID'20) performs asynchronous checkpointing but stores checkpoints in remote persistent storage.</p>
</li>
<li>
<p>Checkfreq(FAST'21): Fdynamically adjusts the checkpointing frequenc.</p>
</li>
<li>
<p>Check-N-Run(NSDI'22): compresses checkpoints with lossy schemes to reduce required storage, but this may harm model accuracy and incur compression overheads.</p>
</li>
</ul>
</details>
<h3 id="24-opportunity">2.4 Opportunity<a class="headerlink" href="#24-opportunity" title="Permanent link">&para;</a></h3>
<ul>
<li>We observe that the CPU memory in GPU machines is sufficient to store a few checkpoints.</li>
</ul>
<figure>
<p><img alt="Alt text" src="../assets/image-88.png" width="500" /></p>
</figure>
<ul>
<li>Because the network connecting GPU instances is optimized for training, its bandwidth is much higher than the bandwidth of the remote persistent storage.</li>
</ul>
<figure>
<p><img alt="Alt text" src="../assets/image-89.png" width="300" /></p>
</figure>
<h2 id="3-designs">3. Designs<a class="headerlink" href="#3-designs" title="Permanent link">&para;</a></h2>
<h3 id="31-checkpoint-placement">3.1 Checkpoint Placement<a class="headerlink" href="#31-checkpoint-placement" title="Permanent link">&para;</a></h3>
<p><em>Given <strong>N</strong> machines and <strong>m</strong> checkpoint replicas, what is the optimal placement strategy to distribute the m replicas among the N machines to <strong>maximize the probability of failure recovery</strong> from CPU memory?</em></p>
<div class="admonition example">
<p class="admonition-title">Mixed placement strategy</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="__tabbed_1_1">N = 4, m = 2</label><label for="__tabbed_1_2">N = 5, m = 2</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><figure markdown>
  <img alt="Alt text" src="../assets/image-97.png" width="width" />
</figure></p>
</div>
<div class="tabbed-block">
<p><figure markdown>
  <img alt="Alt text" src="../assets/image-98.png" width="width" />
</figure></p>
</div>
</div>
</div>
</div>
<ul>
<li>
<p>When <strong>N is divisible by m</strong>, the mixed placement strategy (equals group placement strategy) <strong>is the optimal placement strategy</strong>.</p>
</li>
<li>
<p>When <strong>N is not divisible by m</strong>, the mixed placement strategy minimizes the checkpoint communication time. Its failure recovery probability from CPU memory is <strong>near-optimal</strong> and the <strong>gap is bounded</strong> by <span class="arithmatex">\((2 m-3) /\left(\begin{array}{l}N \\ m\end{array}\right)\)</span>.</p>
</li>
</ul>
<details class="info">
<summary>Corollary</summary>
<p>When <span class="arithmatex">\(N\)</span> is divisible by <span class="arithmatex">\(m\)</span> and <span class="arithmatex">\(k\)</span> machines are disconnected simultaneously, the probability that GEMINI can recover failures from CPU memory is</p>
<div class="arithmatex">\[
\begin{cases}\operatorname{Pr}(N, m, k)=1, &amp; \text { if } k&lt;m \\
\operatorname{Pr}(N, m, k) \geq \max \left\{0,1-\frac{N\left(\begin{array}{c}
N-m \\
k-m
\end{array}\right)}{m\left(\begin{array}{c}
N \\
k
\end{array}\right)}\right\}, &amp; \text { if } m \leq k \leq N\end{cases}
\]</div>
<div class="admonition example">
<p><figure markdown>
  <img alt="Alt text" src="../assets/image-99.png" width="width" />
</figure></p>
</div>
<details class="note">
<summary>Note</summary>
<p>Even for a thousand-scale training cluster, the possibility of two instances having failures at the same time is very limited. Therefore, Gemini with ùëö = 2 can recover failures from CPU memory for most cases.</p>
</details>
</details>
<h3 id="32-traffic-interleaving">3.2 Traffic Interleaving<a class="headerlink" href="#32-traffic-interleaving" title="Permanent link">&para;</a></h3>
<div class="admonition success">
<p class="admonition-title">target</p>
<p><figure markdown>
  <img alt="Alt text" src="../assets/image-90.png" width="400" />
</figure></p>
</div>
<div class="admonition info">
<p class="admonition-title">Difficulties and Approaches</p>
<div class="tabbed-set tabbed-alternate" data-tabs="2:3"><input checked="checked" id="__tabbed_2_1" name="__tabbed_2" type="radio" /><input id="__tabbed_2_2" name="__tabbed_2" type="radio" /><input id="__tabbed_2_3" name="__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="__tabbed_2_1">Naive interleave</label><label for="__tabbed_2_2">Checkpoint partition</label><label for="__tabbed_2_3">Partition with Pipeline</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><figure markdown>
  <img alt="Alt text" src="../assets/image-94.png" width="400" />
</figure></p>
</div>
<div class="tabbed-block">
<p><figure markdown>
  <img alt="Alt text" src="../assets/image-95.png" width="400" />
</figure></p>
</div>
<div class="tabbed-block">
<p><figure markdown>
   <img alt="Alt text" src="../assets/image-96.png" width="400" />
</figure></p>
</div>
</div>
</div>
<details class="example">
<summary>eval</summary>
<p><figure markdown>
  <img alt="Alt text" src="../assets/image-93.png" width="400" />
</figure></p>
</details>
</div>
<details class="note">
<summary>Note</summary>
<p>It is still possible that the total time required for checkpointing cannot be fit in the available network idle timespans, Although checkpoint communications hinder the update operation and prolong the iteration time in this case, Gemini can <strong>reduce the checkpoint frequency to amortize the incurred overhead.</strong></p>
</details>
<ul>
<li>
<p>Gemini adopts online profiling for the first several iterations of training, e.g., 20 iterations in our implementation</p>
</li>
<li>
<p>We observed that the profiled timeline remains almost constant across iterations, The normalized standard deviation of the measurements is less than 10%.</p>
</li>
</ul>
<h3 id="33-system-architecture">3.3 System Architecture<a class="headerlink" href="#33-system-architecture" title="Permanent link">&para;</a></h3>
<figure>
<p><img alt="Alt text" src="../assets/image-92.png" /></p>
</figure>
<details class="info">
<summary>details</summary>
<ul>
<li>
<p>Worker agent monitor their own machine‚Äôs health status and update it in the distributed key-value store.</p>
</li>
<li>
<p>The root agent periodically checks the health status of each training machine from the distributed key-value store</p>
</li>
<li>
<p>Worker agents also periodically check the root machine‚Äôs health status in the distributed key-value store. In the case of a root machine failure, one alive worker machine is promoted as the root machine, and one new worker machine is initialized to replace the failed one.</p>
</li>
<li>
<p>When a training machine replacement is needed, the root agent interacts with the cloud operator to complete the machine replacement and guides the replaced machine where to retrieve its checkpoints</p>
</li>
</ul>
</details>
<ul>
<li>
<p>It leverages CPU memory to store checkpoints for failure recovery, and meanwhile stores checkpoints for other purposes in remote persistent storage.</p>
</li>
<li>
<p>Will fall back to using the low-frequency checkpoints stored in the remote persistent storage for failure recovery.</p>
</li>
</ul>
<h2 id="4-evaluation">4. Evaluation<a class="headerlink" href="#4-evaluation" title="Permanent link">&para;</a></h2>
<p><strong>setup.</strong></p>
<ul>
<li>
<p><strong>16</strong> p4d.24xlarge instances for evaluations. Each instance has <strong>1152GB CPU memory</strong> and it has <strong>8 NVIDIA A100 (40GB)</strong> GPUs</p>
</li>
<li>
<p>p4d.24xlarge instances are connected through a <strong>400Gbps</strong> elastic fabric adaptor (EFA) network</p>
</li>
<li>
<p>We adopt FSx as the remote persistent storage and the aggregated bandwidth is <strong>20Gbps</strong></p>
</li>
</ul>
<!-- - p3dn.24xlarge instances, which have **8 NVIDIA V100 (32GB)** GPUs and are connected to a **100Gbps** EFA network -->

<ul>
<li>workload:</li>
</ul>
<figure>
<p><img alt="Alt text" src="../assets/image-100.png" width="400" /></p>
</figure>
<ul>
<li>Use deepspeed <strong>ZeRO-3</strong> setting; optimizer is <strong>Adam</strong></li>
</ul>
<p><strong>Baselines.</strong></p>
<ul>
<li>
<p>Strawman: checkpoints model states every three hours<sup id="fnref:3"><a class="footnote-ref" href="#fn:3">3</a></sup>, to the remote persistent storage</p>
</li>
<li>
<p>HighFreq: As frequently as possible, to the remote persistent storage</p>
</li>
</ul>
<h3 id="41-training-time">4.1 Training time<a class="headerlink" href="#41-training-time" title="Permanent link">&para;</a></h3>
<div class="admonition example">
<p>Carried out 50 training iterations with Gemini</p>
<div class="tabbed-set tabbed-alternate" data-tabs="3:2"><input checked="checked" id="__tabbed_3_1" name="__tabbed_3" type="radio" /><input id="__tabbed_3_2" name="__tabbed_3" type="radio" /><div class="tabbed-labels"><label for="__tabbed_3_1">iteration time</label><label for="__tabbed_3_2">network idle time</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><figure markdown>
  <img alt="Alt text" src="../assets/image-101.png" width="300" />
</figure></p>
<p>Gemini does not affect the training iteration times</p>
</div>
<div class="tabbed-block">
<p><figure markdown>
  <img alt="Alt text" src="../assets/image-102.png" width="300" />
</figure></p>
<p>there is still available network idle time even after Gemini inserts all the checkpoint traffic</p>
</div>
</div>
</div>
</div>
<h3 id="42-wasted-time">4.2 Wasted time<a class="headerlink" href="#42-wasted-time" title="Permanent link">&para;</a></h3>
<div class="admonition example">
<p>training of GPT-2 100B</p>
<div class="tabbed-set tabbed-alternate" data-tabs="4:3"><input checked="checked" id="__tabbed_4_1" name="__tabbed_4" type="radio" /><input id="__tabbed_4_2" name="__tabbed_4" type="radio" /><input id="__tabbed_4_3" name="__tabbed_4" type="radio" /><div class="tabbed-labels"><label for="__tabbed_4_1">average wasted time</label><label for="__tabbed_4_2">checkpoint time reduction</label><label for="__tabbed_4_3">checkpoint frequency</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>16 p4d.24xlarge instances with different numbers of replaced instances
<figure markdown>
  <img alt="Alt text" src="../assets/image-103.png" width="300" />
</figure></p>
<ul>
<li>
<p>software failures: 1.5√ó the iteration time</p>
</li>
<li>
<p>hardware failures: more than 13√ó compared to HighFreq</p>
</li>
</ul>
</div>
<div class="tabbed-block">
<p><figure markdown>
  <img alt="Alt text" src="../assets/image-104.png" width="300" />
</figure></p>
<ul>
<li>Gemini‚Äôs checkpoint time reduces with an increase in the number of instances in our testbed because it utilizes the aggregated network bandwidth among GPU machines to write checkpoints to the CPU memory.</li>
</ul>
<div class="admonition question">
<p class="admonition-title">Why?</p>
</div>
<ul>
<li>with 16 p4d.24xlarge instances, the reduction is <strong>65√ó</strong> with a 100Gbps network, and it increases to more than <strong>250√ó</strong> with a 400Gbps network.</li>
</ul>
</div>
<div class="tabbed-block">
<p><figure markdown>
  <img alt="Alt text" src="../assets/image-105.png" width="300" />
</figure></p>
<ul>
<li>
<p>Gemini improves the checkpoint frequency over HighFreq by <strong>8√ó</strong> and over Strawman by more than <strong>170√ó</strong></p>
</li>
<li>
<p>the checkpoint frequency of Gemini is <strong>bounded by the iteration time</strong> and it can achieve an even higher frequency with the computation advancement of accelerators.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="footnote">
<hr />
<ol>
<li id="fn:1">
<p><a href="https://github.com/facebookresearch/metaseq/tree/main/projects/OPT/chronicles">OPT-175B logbook</a>&#160;<a class="footnote-backref" href="#fnref:1" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
<li id="fn:2">
<p><a href="https://arxiv.org/pdf/2011.02999.pdf">Understanding and improving failure tolerant training for deep learning recommendation with partial recovery</a>&#160;<a class="footnote-backref" href="#fnref:2" title="Jump back to footnote 2 in the text">&#8617;</a></p>
</li>
<li id="fn:3">
<p>following the setup in training <a href="https://github.com/bigscience-workshop/bigscience/blob/master/train/tr11-176B-ml/chronicles.md">BLOOM</a>&#160;<a class="footnote-backref" href="#fnref:3" title="Jump back to footnote 3 in the text">&#8617;</a></p>
</li>
</ol>
</div>

  <hr>
<div class="md-source-file">
  <small>
    
      ÊúÄÂêéÊõ¥Êñ∞:
      <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago"><span class="timeago" datetime="2023-11-04T03:55:34+00:00" locale="en"></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date">2023-11-04</span>
      
        <br>
        ÂàõÂª∫Êó•Êúü:
        <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago"><span class="timeago" datetime="2023-11-03T16:52:33+00:00" locale="en"></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date">2023-11-03</span>
      
    
  </small>
</div>





                
              </article>
            </div>
          
          
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  ÂõûÂà∞È°µÈù¢È°∂ÈÉ®
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.tabs", "navigation.tracking", "navigation.indexes", "navigation.top", "content.code.select", "content.code.copy", "content.code.select", "content.code.annotate", "toc.follow"], "search": "../../../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.aecac24b.min.js"></script>
      
        <script src="../../../js/timeago.min.js"></script>
      
        <script src="../../../js/timeago_mkdocs_material.js"></script>
      
        <script src="../../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
        <script src="../../../javascripts/katex.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/katex.min.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/contrib/auto-render.min.js"></script>
      
    
  </body>
</html>